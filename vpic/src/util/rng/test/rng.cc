/*~--------------------------------------------------------------------------~*
 *~--------------------------------------------------------------------------~*/

#define CATCH_CONFIG_MAIN  // This tells Catch to provide a main()
#include "catch.hpp"

#include "../../util.h"
#include "src/vpic/vpic_unit_deck.h"

/* Sequence is from the 11213 generator with a seed of 1234 */

static const int N = 1000;
static const unsigned int seq[] = {
   553293926,  698755237, 2442073441, 4209880924, 1764362329, 
  2195309918,  256824928, 2214706803, 2136320427, 2843087932, 
  3486529899, 1306350756, 4270642900, 3297631664, 1850831330, 
  4213109783,  427081536, 1131131307, 2775965886,  877546999, 
  2836645597, 2850507086, 2755759911, 1306876265, 2575673187, 
  1824065691, 3511080041, 1928485268,  649052443, 2971742730, 
   403698108,  169875003,  380295356, 3528011866, 2952256661, 
  3733745051, 4164222377, 1628603045, 2638256790, 3519195868, 
  4195872803, 1476523139, 3699602437, 1672363774, 3684807997, 
  3968862050,  245048207,   33360175,  169770165,  775405269, 
  3191865739, 3052672634, 2175042373,  363825885, 2991060127, 
  3107352189, 2040975233, 2280766171, 1049451347, 2464675372, 
  2786253384,  517425947, 2576418495, 3915167352, 1319262871, 
  3860956986, 3254547342, 1881673000, 1502819804, 2581419104, 
  3993517707, 4179793000, 4134726181,  193902288, 2129660509, 
  1201683060, 2169424339, 1171199755, 3270482785, 2589967476, 
  1245732811, 2180825597, 4108548794, 3943541881, 1664725995, 
  3482571249, 3960328275, 2496083819, 2285170479,  707491711, 
  1973753445, 2559837769, 3759732527, 3621894707, 2667897962, 
  2786661035, 2316413096, 4122623937, 1564737819, 3606925948, 
  3141917404, 3237355011, 4148255857, 3198176564,  899012754, 
  1921496599, 2722540422, 2314650322, 3316686314,  486198287, 
  3446984721,  359923326, 4170566747, 1715634878, 3002640485, 
  2198169011, 1709206686, 1602063393, 1768555127,  296016403, 
   707947167, 4149178993, 2286171885, 3606834898,  860116794, 
   837512047, 2780968890, 2934517872, 3265475992, 3995475331, 
   823251686, 1388379685, 1689938384,  924010855,  801623899, 
  2370143426,  978918237, 3737022385, 1478921360, 3119535156, 
  3224513071, 3275923638, 2867594136,  731709579, 3968236195, 
    64525079,  272371898, 4238912616, 1886765573, 3761754562, 
  1000710391, 2048957979,  312497819,  439741686,  924925889, 
  3994889236,   52289190,  759549430, 2584954556,  756493366, 
   168627065,  857399839, 3425284973,  959170692, 1975409876, 
   925869263, 1735262701, 3394788651,  550383511,  490309361, 
   881075537, 2070029863, 1223376354, 2762562712, 2355745036, 
  4058079425,  688888168, 2084555594, 2213905937, 1164042303, 
  3938114127, 3862067658, 1899582417, 2637725755, 1855007909, 
  1289092282, 3474658897, 2719086468, 2644140387, 3572064696, 
  2835757420, 3854845607,  995529688, 2400664527, 2684303099, 
  1002902183, 2708291817, 1162219077, 1458303374, 2328212094, 
  2278558260, 2811513813,  187682146, 3731777450, 1369014755, 
  4107243587, 4249288801, 3167574229, 2433688524, 1263841578, 
  4178639597,  103168337,  726791243, 3865077042,  468986147, 
  1352009278, 2120693945, 2257059684, 2511574244,  282332575, 
   943738722,  765376122, 3886666299, 2550905672, 3021593314, 
  1563487207, 2902762078, 2131594494, 1640852828, 2051546052, 
   533501181, 3599888918, 2717252360, 2048541279,  449906823, 
  4214508583,  407826952, 1220354008, 3680787680,  874143422, 
  2771749303, 3918211583, 1933979094, 2397328810, 2048627355, 
  1066449138,  620406396, 1265779869,   82128565, 3162944753, 
  1216223916, 1462377073, 2410881086, 3283960481, 2698235827, 
  1293536964, 1062717153,  737566608, 1581406402,   97798499, 
  4147949360, 3084486205, 3702594522, 1519104056,  796070846, 
  1353803554, 3887612590, 3110269517,  733537104,  705633439, 
  2781674078,  991272693,  916020596, 3545700981,  220687238, 
   324363525, 2561026636, 3521913746, 3070945031, 2373998044, 
  3146062523, 1137989108, 3961642762, 3895747052, 1580424738, 
  3667204475, 1010913545, 2234226736, 4019446758,  727087410, 
  4059848248, 2936062142, 3183958929, 3882269258, 3455933746, 
  1356303281, 4279894400, 2251669780,  133524669, 1908619621, 
  2907753894,  364805371, 3022035474, 2844816175, 3612488522, 
  3506546721, 1443147198, 1217370657, 3834938319, 1100686954, 
   489874032, 2821199686, 3650884881, 3171161774, 3305651455, 
  1771732079, 1462745239, 2313021630,  733759255, 2146937574, 
  2232389715,  326010464, 2874477323, 4182050638, 2190268358, 
  3013967555, 2540452868, 1319520735, 3037507174, 1074278118, 
  3719401211, 2013303214, 2756190478, 2387141578,  180439427, 
  3993230439, 2862452196, 2557110861, 3728952268, 1253230935, 
   781742369, 2744212073, 1353835579, 3955007660,  914260429, 
  1339735569,  747434431,  643113688, 2071932020, 2899349882, 
  3223077155, 1630920461, 1463073770,  630145878, 3050743218, 
  3516525223, 3480270450,  294098109, 4063336363, 2361143405, 
  2013101517, 2785286939, 1503734644, 3839462541, 4074196387, 
  1117196373, 2048922479, 2388244186, 2413315060, 2367315280, 
  3349315306, 2936256882, 4068808092, 1372059822, 1149208750, 
  3401323389, 2755773423, 2860092467, 1505179007, 3793739167, 
  2348158578, 2812841843, 3568987390, 3339508196, 1360318330, 
   487859816, 3192619943, 1942716817, 3417059105, 2006941363, 
  3876292868, 3966499501, 3343575128, 1320062019, 4052874294, 
  1661660417, 3278328199,  667015521, 2547492577, 2504792501, 
  3304712274,  481758187, 3614301650, 3369442324, 2121036589, 
  3692381588,  389150458, 2736546189, 1376548125, 1622203973, 
  3300072739, 2789882526, 3881344628,   34239194, 4256374384, 
   515810405, 1337208030, 4076098244, 3273673306, 4049989741, 
  2223726553, 1600951795, 3374458346, 3959457033, 4038761321, 
  3738299300, 3475534027,  315621578, 2566360079,  400233151, 
  3198002493, 4000178367, 3003537992, 2418185466, 4133921279, 
  3950353604, 3290950939,  105405052, 2073632531, 2567135797, 
  2114529127,  617722918,  574897074,  145060013, 3481202032, 
   278011874, 4169773197, 1353827771, 1239826005, 4142475495, 
  2389529339, 3666924805, 2066381368,    6789416, 1668443782, 
  3196261404, 3514547288, 4026411825,  802392020, 2677514010, 
  2787660169, 3939691420, 3204448871, 2381714337, 1233034256, 
  2984307665, 1103407055, 3031977605, 2409144418, 1140946250, 
  3222997334,  280241001, 2085596678,  520966818,  510353206, 
   208665480, 3795213078,  288783070, 2098371164,  562326118, 
  3233670196, 2553636526,  522053470, 1828316355, 4214319056, 
   452855188, 2302876034,  924621805,  191866231, 4089907614, 
  4143273946, 2854199969, 4188327916, 4109927523, 2056850061, 
  1218639351, 3152774385, 3248416571, 4139264331,  673684274, 
  1841624903,   37564639, 1701880855, 2249177851,  729274386, 
   428106918, 4181452858,  347163906, 1863870163, 3001348367, 
  3537322846, 1225876535, 4022036962,  714821668, 3243025973, 
  3845974554, 2663355489, 4212970629, 2993122213, 3666588071, 
  3380238642, 2513936028, 2212417121, 2955814918,  569232806, 
  3154916977, 3107294339, 3134048835, 3849011673, 3836294919, 
  3734889980,  164091041, 2030878622, 1419071374,  346851020, 
  1377631226, 1289968696,  962784564, 2020590972,  421488551, 
  3180838841, 2053804618,  690498077, 2594130153, 1858540204, 
  2316849314, 1897091063, 1326185749, 3880467220, 1013841045, 
  2510006459,  200757585, 1706901250,  507983600, 2286361318, 
  2687095773, 2439114934, 3785940507, 2910927696,  495212298, 
  1737826401,  275378906, 1933723674, 1120172738, 2170670353, 
   703797292,  793855448, 1884515135, 3720836500, 1734151247, 
  3858004935, 1423598860, 1976443512, 1142497044, 2446033335, 
  1228821251, 2197570102,  146344084, 3365694978,  355468092, 
   881096899,  931732364, 3350199871, 3243058622,  245057594, 
  4278566245, 1408621021, 2506645410, 1267060469, 1365764095, 
    33272254, 2646325483, 1709890154,  442316585,  538779104, 
  3412560582,  828087032, 2053596312, 2772521746,  894578119, 
   201257826, 2291277544, 3599460260, 2893282544, 1783425940, 
  2778987415, 2575736397, 2012251818, 2003236969, 3481419440, 
  1234904448, 1194524734, 3660540193, 2209734072, 1072263624, 
  2734463137, 3382453617, 2661765428,  642404874, 3533639813, 
  3326229745, 2297215451, 2477704233,  195299388, 1781116828, 
  3276896535, 2771181349,  348737860, 1379297272, 3012409305, 
   571556070,   91329936, 3368648619, 4135205696, 2115649999, 
  1627132802, 2941027473, 1066966330, 3576075844, 2982957512, 
  1380172142,  613840578, 2425556655,   84325493, 1157833380, 
   380526350, 4039021014, 1290253449,  545146169, 2529775161, 
   427361307, 4182711492,  883562403,   59017230,   25492125, 
  1099369309, 3505470186, 2881491845, 2566852819, 2871303793, 
  3788442890, 2869657037,  801373099, 3358326700, 3419416145, 
   843059834, 3762692802, 4171146309, 3260102383, 4031587170, 
  2675507635,  838206744, 3681419048, 2099605932, 2127485526, 
   926849448, 1980170805, 1438224173, 3523576643,  926000523, 
   921155423,  180162584, 2033580132, 3202819054, 4274281899, 
    69381977, 3353380750, 1092443156, 3825831970, 1248974759, 
  3565713812, 1256704162, 1217134093, 1591142327, 1752494917, 
  3028371512, 1958303331, 1850071672, 1217813873, 2916267074, 
  2374819653, 3587666539, 4104385618, 3253865448, 3488338117, 
   949576801,  689565959, 4110396943, 2660759860, 1472458161, 
  3610122826,  180814354, 3695546105, 1577211192, 1424463045, 
  2848290167, 4040830260, 2890841189,  920378244,  136171106, 
  4066704554, 2505125024,  532297214, 2924909261,  530183725, 
  1877714361, 2069794883,  332588948, 1738987415, 3417039337, 
  3566072804, 3310481469, 2816418630, 1926132498, 2214615551, 
  1599351183, 1233470572, 1696978507, 1606997108, 3913303019, 
  1946659740, 2966027013, 2182553097, 1357275782, 1374421849, 
  3138941674, 1105100192, 4222346580, 2362357402, 1279700422, 
   249844665, 3656189515,  580604409, 2189793371, 3131564844, 
  2650695683, 3243504545, 3397723045, 4188316599, 3026572267, 
   907127125, 3405628562,  830752183, 1292469083, 2111044366, 
   224549056, 4169187060,  454544759, 2474323400,  609923725, 
  3194353098, 1869536251, 4096821340, 2152204142, 1225922401, 
  1381918119, 3791021138,  517181631, 4016322084, 1076718013, 
  1207923521, 1607526999, 3517963918,  171965789, 4124668424, 
   876823670, 3547237734, 3510460793, 1383243182,   81851397, 
  4122318508, 4096995620, 4238234251, 1369415583, 3357744380, 
  1755168431, 3402210424, 2708770915, 2178593232, 2230490979, 
  3850592336,  395202753, 1145970800, 2073751834, 4019268122, 
  1715664056, 2670712766,  511797051, 1298315286,  750155609, 
  2511075420, 3724283654, 3264667428, 3297812813, 2794646432, 
   792075244, 1481885653, 3821585101, 3356348441, 3067087482, 
  2351213299, 2914492104, 3578170041, 2068541578, 2559734620, 
  1449473034, 1515443287, 1503937449, 3731228403, 3301242979, 
  2675666516, 1453384331,  275781647, 1513899836, 1057387684, 
  2524963245, 3897058285, 3845220976,  927032671,  597054215, 
  1488976437,  816921064,  183760231, 2679276644, 3669514486, 
  2550447080, 2645963843,  519530310, 3972602610,  660791018, 
  2209454157, 3286137393, 1764490893, 3722356670, 3818175380, 
  3812758152, 2781451830, 2816833912,  845403569, 2456431864, 
   129871448, 2010242160,  983068913, 4125747311, 2193597351, 
   450223202, 2213550157, 2219064558, 3324952925, 2447629198, 
  4188828518, 1944720473, 2668121873,  256251632, 3141431621, 
   862629169, 1986498648, 3852489741, 1305422895, 1395752592, 
  2678110086, 3356575208, 2203525424, 4148844695, 1801851064, 
  1148643645,  550804577, 1041274339, 3776082391, 3759739470, 
  1746757602, 2594443401, 4019087208, 2706490867, 2087847544, 
  2009753800, 1119878086, 1168778453, 2726806895, 3240455892, 
  1567033770, 1407377442,  337526830,   18962543,  247615138, 
  3510873826, 3685265114,  722017411, 1469421282,  239638616, 
  4136684102, 1352947701,  547594847, 1141032357, 1384197850, 
  2489754464,  834585989,  622533931,  416760316, 3890426510, 
  4208125764, 1854255901, 2488983923, 2510508267, 2931259896, 
  3940181108, 2096823000, 2661847721, 4008234493, 1602830869, 
  3598000046,  215303987,  508369812,  276413009,  371619631, 
   796969723, 4202155772, 2161050256, 3334645789,   77707822, 
   881847475, 1209069193, 2503105966,  433721509,  985791955, 
  3389467611, 4157689377, 2288410534, 2806875726,  467572461, 
  1064356101, 1710832805,  242792642,  343019004,  659238831, 
   334161479,  235290899, 3233084111, 3866085073, 1683915436, 
  4245718284,  167318999, 3539996379, 3628010425, 1850237454, 
   290721491, 2854158795, 3243323549, 1489524335, 2819941436, 
  3548231239,  447435310, 1997028181, 1952879485, 2254426422, 
  3813914344, 3969754167,  232325977, 3736416005, 3159635804, 
  2769427612, 1971270154, 3705493847, 2558969475, 1039180510, 
  3468554367, 2988029559, 1400167238, 1768303901, 2758662123, 
  2072997009, 1332330347,  179681555, 2315290438, 2429393974, 
   509881964, 3807607878, 3055319970,  671840881, 3477325874 };

/* FIXME: IMPROVE COVERAGE */
TEST_CASE("uirand", "[rng]") {

  boot_checkpt(NULL, NULL);

  int i;
  rng_t * rng = new_rng( 1234 );
  for( i=0; i<N; i++ ) if( uirand( rng )!=seq[i] ) break;
  REQUIRE_FALSE( i!=N );
  delete_rng(rng);
} // TEST
